# http_api

Тестовое задание: "Хранилище файлов с доступом по http"

В данном коде реализован демон, предоставляющий HTTP API для загрузки файлов (upload), их скачивания (download) и удаления (delete).
Использованные технологии: `python3`, `Flask`, `gunicorn`, `bash`, `curl`.

`upload`: соответствует методу `POST` (upload.sh); 
- сохраняет файл в директории `store` (которую необходимо создать в корневой папке с кодом): файл не будет сохранен в хранилище повторно, если хэш загруженных файлов совпадает;
- директория, в которой будет храниться сохранненый файл имеет следующий вид: `/store/ab/abcdefgh12345`, где `abcdefgh12345- хэш файла, `/ab/` - первые 2 символа хэша;
- алгоритм хэширования `md5` из стандартной библиотеки `hashlib`

`download`: соответствует методу `GET` (download.sh);
- для загрузки файла из хранилища клиентом необходимо передать хэш искомого файла;
- при повтороной загрузке файл перезапишется у клиента;

`delete`: соответствует методу `DELETE` (delete.sh);
- для удаления файла из хранилища клиентом необходимо передать хэш искомого файла;
- при попытке удаления файла с несуществующем в хранилище хэшом, будет выдано сообщение "No such file!";

**Код**

1. `upload.sh` - осуществляет загрузку файла в хранилище.
Пример: `./upload.sh /home/user/test.jpg` (первый аргумент - путь к файлу)

Отмечу: для того, чтобы файлы корректно передавались в виде байтов с помощью данной команды в хранилище в скрипте было указано `--data-binary` и `-H'Content-Type: application/octet-stream'`


2. `download.sh` - осуществляет загрузку файла из хранилища по хэшу в директорию `Downloads`.
Пример: `./download.sh abcdefgh12345` (первый аргумент - хэш файла в хранилище)

3. `delete.sh` - удаление файла из хранилища по хэшу.
Пример: `./delete.sh abcdefgh12345` (первый аргумент - хэш файла в хранилище).

4. `run.sh` - запускает `gunicorn` с 1 воркером и портом 5000.
`gunicorn` в данном случае выступает и как веб-сервер, и как сервер веб-приложения.

**Запуск**
Для начала установим `gunicorn` и `flask`.

`cd ~`
`python3 -m venv env`
`source env/bin/activate`
`pip install -r requirements.txt`
`cd path_to_http_api` (path_to_http_api - путь к сурс коду)
`./run.sh`

Теперь можно использовать из терминала:
`./upload.sh path_to_file`
`./download.sh file_hash`
`./delete.sh file_hash`

Для примера работы с файлами в репозитории добавлены файлы `test.jpg` и `text.txt`.